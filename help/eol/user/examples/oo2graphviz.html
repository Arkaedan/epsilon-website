<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <link rel="stylesheet" href="../../../common/css/style.css" charset="ISO-8859-1" type="text/css">
  <title>Generating GraphViz graphs from OO models using EOL</title>
</head>


<body>

<h2>Generating Graphviz graphs from OO models</h2>

<p>In this example we need to produce graphical representations of OO models. To achieve this we are using GraphViz, a graph visualization software (available at <a href="http://www.graphviz.org">www.graphviz.org</a>). The EOL program displayed in Listing 1 generates a new file that contains the representation of the input model as a GraphViz-compatible graph.</p>
<h3>EOL Program</h3>
<code>
<b><font color='#7F0055'>var</font></b>&nbsp;buffer&nbsp;:&nbsp;<b><font color='#7F0055'>String</font></b>;<br>
<br>
<font color='#2A00FF'>'digraph&nbsp;G&nbsp;{&nbsp;'</font>.println();<br>
<font color='#2A00FF'>'&nbsp;&nbsp;node&nbsp;[shape=record,&nbsp;fontname=Tahoma,&nbsp;fontsize=10];'</font>.println();<br>
<font color='#2A00FF'>'&nbsp;&nbsp;edge&nbsp;[fontname=Tahoma,&nbsp;fontsize=8];'</font>.println();<br>
<font color='#2A00FF'>'&nbsp;&nbsp;center=true;'</font>.println();<br>
<font color='#2A00FF'>'&nbsp;&nbsp;nodesep=1.5;'</font>.println();<br>
<br>
<b><font color='#7F0055'>for</font></b>&nbsp;(class&nbsp;<b><font color='#7F0055'>in</font></b>&nbsp;Class.allInstances.select(c|c.extends.isDefined())){<br>
&nbsp;&nbsp;(<font color='#2A00FF'>'&nbsp;&nbsp;_'</font>&nbsp;+&nbsp;class.name&nbsp;+&nbsp;<font color='#2A00FF'>'->_'</font>&nbsp;+&nbsp;class.extends.name&nbsp;+&nbsp;<font color='#2A00FF'>'&nbsp;[arrowhead=onormal];'</font>).println();<br>
}<br>
<br>
<b><font color='#7F0055'>for</font></b>&nbsp;(class&nbsp;<b><font color='#7F0055'>in</font></b>&nbsp;Class.allInstances()){<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;<b><font color='#7F0055'>var</font></b>&nbsp;node&nbsp;:&nbsp;<b><font color='#7F0055'>String</font></b>;<br>
&nbsp;&nbsp;node&nbsp;:=&nbsp;<font color='#2A00FF'>'&nbsp;&nbsp;_'</font>&nbsp;+&nbsp;class.name&nbsp;+&nbsp;<font color='#2A00FF'>'&nbsp;[label="{'</font>&nbsp;+&nbsp;class.getLabel()&nbsp;+&nbsp;<font color='#2A00FF'>'|{'</font>;<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;<b><font color='#7F0055'>for</font></b>&nbsp;(attr&nbsp;<b><font color='#7F0055'>in</font></b>&nbsp;class.features.select(f|f.isTypeOf(Attribute))){<br>
&nbsp;&nbsp;&nbsp;&nbsp;node&nbsp;:=&nbsp;node&nbsp;+&nbsp;attr.getLabel()&nbsp;+&nbsp;<font color='#2A00FF'>'\\n'</font>;<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;node&nbsp;:=&nbsp;node&nbsp;+&nbsp;<font color='#2A00FF'>'}|{}}"];'</font>;<br>
&nbsp;&nbsp;node.println();<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;<b><font color='#7F0055'>for</font></b>&nbsp;(ref&nbsp;<b><font color='#7F0055'>in</font></b>&nbsp;class.features.select(f|f.isTypeOf(Reference)))&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;(<font color='#2A00FF'>'&nbsp;&nbsp;_'</font>&nbsp;+&nbsp;class.name&nbsp;+&nbsp;<font color='#2A00FF'>'->_'</font>&nbsp;+&nbsp;ref.type.name&nbsp;+&nbsp;<font color='#2A00FF'>'&nbsp;[label="'</font>&nbsp;+&nbsp;ref.getLabel()&nbsp;+&nbsp;<font color='#2A00FF'>'",arrowhead=normal];'</font>).println();<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;<br>
}<br>
<br>
<font color='#2A00FF'>'}'</font>.println();<br>
<br>
buffer.store(OO.modelFile.replace(<font color='#2A00FF'>'.ecore'</font>,<font color='#2A00FF'>'.graph'</font>));<br>
<br>
<font color='#3F7F5F'>--&nbsp;Returns&nbsp;the&nbsp;label&nbsp;of&nbsp;a&nbsp;Reference<br>
</font><b><font color='#7F0055'>operation</font></b>&nbsp;Reference&nbsp;getLabel()&nbsp;:&nbsp;<b><font color='#7F0055'>String</font></b>&nbsp;{<br>
&nbsp;&nbsp;<b><font color='#7F0055'>var</font></b>&nbsp;upper&nbsp;:&nbsp;<b><font color='#7F0055'>String</font></b>;<br>
&nbsp;&nbsp;<b><font color='#7F0055'>if</font></b>&nbsp;(<i><font color='#2A00FF'>self</font></i>.isMany){<br>
&nbsp;&nbsp;&nbsp;&nbsp;upper&nbsp;:=&nbsp;<font color='#2A00FF'>'*'</font>;<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;<b><font color='#7F0055'>var</font></b>&nbsp;name&nbsp;:&nbsp;<b><font color='#7F0055'>String</font></b>;<br>
&nbsp;&nbsp;<b><font color='#7F0055'>return</font></b>&nbsp;<i><font color='#2A00FF'>self</font></i>.name&nbsp;+&nbsp;<font color='#2A00FF'>'&nbsp;'</font>&nbsp;+&nbsp;upper;<br>
<br>
}<br>
<br>
<font color='#3F7F5F'>--&nbsp;Returns&nbsp;the&nbsp;label&nbsp;of&nbsp;an&nbsp;Attribute<br>
</font><b><font color='#7F0055'>operation</font></b>&nbsp;Attribute&nbsp;getLabel()&nbsp;:&nbsp;<b><font color='#7F0055'>String</font></b>&nbsp;{<br>
&nbsp;&nbsp;<b><font color='#7F0055'>var</font></b>&nbsp;upper&nbsp;:&nbsp;<b><font color='#7F0055'>String</font></b>;<br>
&nbsp;&nbsp;<b><font color='#7F0055'>if</font></b>&nbsp;(<i><font color='#2A00FF'>self</font></i>.isMany){upper&nbsp;:=&nbsp;<font color='#2A00FF'>''</font>;}<br>
&nbsp;&nbsp;<b><font color='#7F0055'>return</font></b>&nbsp;<i><font color='#2A00FF'>self</font></i>.name&nbsp;+&nbsp;<font color='#2A00FF'>'&nbsp;:&nbsp;'</font>&nbsp;+&nbsp;<i><font color='#2A00FF'>self</font></i>.type.name&nbsp;+&nbsp;<font color='#2A00FF'>'&nbsp;'</font>&nbsp;+&nbsp;upper;<br>
}<br>
<br>
<b><font color='#7F0055'>operation</font></b>&nbsp;Class&nbsp;getLabel()&nbsp;:&nbsp;<b><font color='#7F0055'>String</font></b>&nbsp;{<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;<b><font color='#7F0055'>var</font></b>&nbsp;label&nbsp;:&nbsp;<b><font color='#7F0055'>String</font></b>;<br>
&nbsp;&nbsp;label&nbsp;:=&nbsp;<i><font color='#2A00FF'>self</font></i>.name;<br>
&nbsp;&nbsp;<b><font color='#7F0055'>if</font></b>&nbsp;(<i><font color='#2A00FF'>self</font></i>.package.isTypeOf(Package)){<br>
&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;:=&nbsp;label&nbsp;+&nbsp;<font color='#2A00FF'>'\\n&nbsp;(from&nbsp;'</font>&nbsp;+&nbsp;<i><font color='#2A00FF'>self</font></i>.package.name&nbsp;+&nbsp;<font color='#2A00FF'>')'</font>;<br>
&nbsp;&nbsp;}<br>
&nbsp;&nbsp;<b><font color='#7F0055'>return</font></b>&nbsp;label;<br>
}<br>
<br>
<b><font color='#7F0055'>operation</font></b>&nbsp;<b><font color='#7F0055'>Any</font></b>&nbsp;println()&nbsp;{<br>
&nbsp;&nbsp;buffer&nbsp;:=&nbsp;buffer&nbsp;+&nbsp;<i><font color='#2A00FF'>self</font></i>&nbsp;+&nbsp;<font color='#2A00FF'>'\r\n'</font>;<br>
}
</code>
</body>
</html>
